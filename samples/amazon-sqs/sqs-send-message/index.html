<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.39-DEV" />
    <meta name="description" content="TIBCO Cloud Integration - Flogo SDK">
<meta name="author" content="retgits">

    <link rel="shortcut icon" href="https://www.tibco.com/sites/tibco/files/favicon_0.ico" type="image/vnd.microsoft.icon">
    <title>Sending a message :: TIBCO Cloud Integration - Flogo SDK</title>
    
    
    <link href="/tci-flogo/css/nucleus.css?1523556550" rel="stylesheet">
    <link href="/tci-flogo/css/font-awesome.min.css?1523556550" rel="stylesheet">
    <link href="/tci-flogo/css/hybrid.css?1523556550" rel="stylesheet">
    <link href="/tci-flogo/css/featherlight.min.css?1523556550" rel="stylesheet">
    <link href="/tci-flogo/css/perfect-scrollbar.min.css?1523556550" rel="stylesheet">
    <link href="/tci-flogo/css/auto-complete.css?1523556550" rel="stylesheet">
    <link href="/tci-flogo/css/theme.css?1523556550" rel="stylesheet">
    <link href="/tci-flogo/css/hugo-theme.css?1523556550" rel="stylesheet">
    
      <link href="/tci-flogo/css/theme-blue.css?1523556550" rel="stylesheet">
    

    <script src="/tci-flogo/js/jquery-2.x.min.js?1523556550"></script>
    
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{ 
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/tci-flogo/samples/amazon-sqs/sqs-send-message/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <svg id="icon-logo-tibco" viewBox="0 0 83 32" width="100%" height="100%">
    <title>logo-tibco</title>
    <path fill="#3e8ede" style="fill: var(--color11, #FFFFFF)" d="M9.361 6.199v16.837h-2.594v-16.837h-6.766v-2.471h16.126v2.471h-6.766z"></path>
    <path fill="#3e8ede" style="fill: var(--color11, #FFFFFF)" d="M19.215 23.036v-19.308h2.595v19.308h-2.595z"></path>
    <path fill="#3e8ede" style="fill: var(--color11, #FFFFFF)" d="M40.122 17.569c0 3.274-2.194 5.467-7.166 5.467h-6.581v-19.308h6.395c4.666 0 6.734 2.1 6.734 5.128 0 1.978-1.143 3.43-3.306 4.233 2.565 0.648 3.923 2.317 3.923 4.48zM32.986 6.138h-3.985v6.055c0.030 0 3.583 0 3.583 0 2.78 0 4.294-1.235 4.294-3.12 0-1.854-1.359-2.935-3.893-2.935zM32.801 14.571h-3.8v6.055h4.202c2.873 0 4.294-1.020 4.294-3.027 0.001-2.225-1.977-3.028-4.696-3.028z"></path>
    <path fill="#3e8ede" style="fill: var(--color11, #FFFFFF)" d="M57.242 7.25c-1.699-1.112-3.274-1.637-5.282-1.637-4.202 0-7.014 2.904-7.014 7.693s2.842 7.847 7.075 7.847c2.070 0 4.109-0.834 5.467-1.884l0.433 2.626c-1.575 0.989-3.8 1.606-5.962 1.606-5.654 0-9.67-3.923-9.67-10.071s4.048-10.166 9.671-10.166c2.193 0 4.541 0.618 6.117 1.607l-0.835 2.378z"></path>
    <path fill="#3e8ede" style="fill: var(--color11, #FFFFFF)" d="M73.985 4.626c-0.286-0.177-0.584-0.338-0.893-0.482-2.524 4.838-7.11 10.595-13.178 13.87 0.35 0.785 0.793 1.495 1.316 2.125 5.217-3.587 10.049-9.587 12.754-15.512z"></path>
    <path fill="#3e8ede" style="fill: var(--color11, #FFFFFF)" d="M72.863 4.041c-1.248-0.543-2.661-0.834-4.194-0.834-5.676 0-9.686 4.381-9.686 10.149 0 0.973 0.103 1.89 0.298 2.746 5.806-2.367 10.966-7.584 13.582-12.061z"></path>
    <path fill="#3e8ede" style="fill: var(--color11, #FFFFFF)" d="M74.203 4.762c-2.978 7.323-6.607 12.506-11.242 16.964 1.566 1.087 3.515 1.686 5.708 1.686 5.677 0 9.686-4.411 9.686-10.18 0-3.822-1.582-6.787-4.151-8.47z"></path>
    <path fill="#3e8ede" style="fill: var(--color11, #FFFFFF)" d="M78.354 4.122v-0.015c0-1.361 1.103-2.507 2.494-2.507 1.404 0 2.494 1.132 2.494 2.494v0.014c0 1.362-1.103 2.508-2.494 2.508-1.404 0.001-2.494-1.132-2.494-2.493zM83.054 4.107v-0.014c0-1.218-0.946-2.222-2.207-2.222-1.247 0-2.207 1.018-2.207 2.235v0.015c0 1.218 0.946 2.221 2.207 2.221 1.247 0 2.207-1.017 2.207-2.236zM79.873 2.79h1.146c0.559 0 0.975 0.272 0.975 0.802 0 0.416-0.244 0.674-0.588 0.774l0.674 0.96h-0.587l-0.602-0.874h-0.531v0.874h-0.487v-2.536zM80.977 4.050c0.33 0 0.516-0.172 0.516-0.416 0-0.272-0.186-0.415-0.516-0.415h-0.617v0.831h0.617z"></path>
</svg>
    </div>
    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/tci-flogo/introduction/" title="Introduction" class="dd-item 
        
        
        
        ">
      <a href="/tci-flogo/introduction/">
          <i class="fa fa-home" aria-hidden="true"></i> Introduction
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/tci-flogo/getting-started/" title="Getting started" class="dd-item 
        
        
        
        ">
      <a href="/tci-flogo/getting-started/">
          <i class="fa fa-bolt" aria-hidden="true"></i> Getting started
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/tci-flogo/getting-started/prerequisites/" title="Prerequisites" class="dd-item 
        
        
        
        ">
      <a href="/tci-flogo/getting-started/prerequisites/">
          Prerequisites
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/getting-started/prerequisites/flogo/" title="Use Project Flogo activities" class="dd-item ">
        <a href="/tci-flogo/getting-started/prerequisites/flogo/">
        Use Project Flogo activities
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/getting-started/prerequisites/new-activities/" title="Create new activities" class="dd-item ">
        <a href="/tci-flogo/getting-started/prerequisites/new-activities/">
        Create new activities
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/tci-flogo/getting-started/dev-environment/" title="Set up your environment" class="dd-item 
        
        
        
        ">
      <a href="/tci-flogo/getting-started/dev-environment/">
          Set up your environment
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/getting-started/dev-environment/intellij-webstorm/" title="Using IntelliJ WebStorm" class="dd-item ">
        <a href="/tci-flogo/getting-started/dev-environment/intellij-webstorm/">
        Using IntelliJ WebStorm
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/getting-started/dev-environment/vscode/" title="Using VS Code" class="dd-item ">
        <a href="/tci-flogo/getting-started/dev-environment/vscode/">
        Using VS Code
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/tci-flogo/tooling/" title="Tooling" class="dd-item 
        
        
        
        ">
      <a href="/tci-flogo/tooling/">
          <i class="fa fa-angle-double-right" aria-hidden="true"></i> Tooling
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/tooling/tooling/" title="fe-cli" class="dd-item ">
        <a href="/tci-flogo/tooling/tooling/">
        <i class="fa fa-terminal" aria-hidden="true"></i> fe-cli
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/tci-flogo/extensions/" title="Building extensions" class="dd-item 
        
        
        
        ">
      <a href="/tci-flogo/extensions/">
          <i class="fa fa-wrench" aria-hidden="true"></i> Building extensions
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/tci-flogo/extensions/organizing-code/" title="Organizing your code" class="dd-item 
        
        
        
        ">
      <a href="/tci-flogo/extensions/organizing-code/">
          Organizing your code
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/extensions/organizing-code/connector-json/" title="connector.json" class="dd-item ">
        <a href="/tci-flogo/extensions/organizing-code/connector-json/">
        connector.json
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/extensions/organizing-code/connector-ts/" title="connector.ts" class="dd-item ">
        <a href="/tci-flogo/extensions/organizing-code/connector-ts/">
        connector.ts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/extensions/organizing-code/activity-json/" title="activity.json" class="dd-item ">
        <a href="/tci-flogo/extensions/organizing-code/activity-json/">
        activity.json
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/extensions/organizing-code/activity-go/" title="activity.go" class="dd-item ">
        <a href="/tci-flogo/extensions/organizing-code/activity-go/">
        activity.go
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/extensions/organizing-code/activity-ts/" title="activity.ts" class="dd-item ">
        <a href="/tci-flogo/extensions/organizing-code/activity-ts/">
        activity.ts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/extensions/organizing-code/trigger-json/" title="trigger.json" class="dd-item ">
        <a href="/tci-flogo/extensions/organizing-code/trigger-json/">
        trigger.json
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/extensions/organizing-code/trigger-ts/" title="trigger.ts" class="dd-item ">
        <a href="/tci-flogo/extensions/organizing-code/trigger-ts/">
        trigger.ts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/extensions/organizing-code/trigger-go/" title="trigger.go" class="dd-item ">
        <a href="/tci-flogo/extensions/organizing-code/trigger-go/">
        trigger.go
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/extensions/organizing-code/display-settings/" title="Display settings" class="dd-item ">
        <a href="/tci-flogo/extensions/organizing-code/display-settings/">
        Display settings
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/tci-flogo/extensions/upload/" title="Upload to TCI" class="dd-item 
        
        
        
        ">
      <a href="/tci-flogo/extensions/upload/">
          Upload to TCI
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/tci-flogo/sdk/" title="SDK" class="dd-item 
        
        
        
        ">
      <a href="/tci-flogo/sdk/">
          <i class="fa fa-list-alt" aria-hidden="true"></i> SDK
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/tci-flogo/samples/" title="Samples" class="dd-item 
        parent
        
        
        ">
      <a href="/tci-flogo/samples/">
          <i class="fa fa-cogs" aria-hidden="true"></i> Samples
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/tci-flogo/samples/concat/" title="Concat" class="dd-item 
        
        
        
        ">
      <a href="/tci-flogo/samples/concat/">
          Concat
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/samples/concat/simple-concat/" title="Simple concat" class="dd-item ">
        <a href="/tci-flogo/samples/concat/simple-concat/">
        Simple concat
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/samples/concat/separator-concat/" title="Adding a separator token" class="dd-item ">
        <a href="/tci-flogo/samples/concat/separator-concat/">
        Adding a separator token
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/samples/concat/ui-choices-concat/" title="Adding more UI options" class="dd-item ">
        <a href="/tci-flogo/samples/concat/ui-choices-concat/">
        Adding more UI options
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/tci-flogo/samples/amazon-sqs/" title="Amazon SQS" class="dd-item 
        parent
        
        
        ">
      <a href="/tci-flogo/samples/amazon-sqs/">
          Amazon SQS
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/samples/amazon-sqs/sqs-connector/" title="Connector" class="dd-item ">
        <a href="/tci-flogo/samples/amazon-sqs/sqs-connector/">
        Connector
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/samples/amazon-sqs/sqs-send-message/" title="Sending a message" class="dd-item active">
        <a href="/tci-flogo/samples/amazon-sqs/sqs-send-message/">
        Sending a message
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tci-flogo/samples/amazon-sqs/sqs-receive-message/" title="Receiving a message" class="dd-item ">
        <a href="/tci-flogo/samples/amazon-sqs/sqs-receive-message/">
        Receiving a message
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/tci-flogo/contribute/" title="Contribute" class="dd-item 
        
        
        
        ">
      <a href="/tci-flogo/contribute/">
          <i class="fa fa-share-alt" aria-hidden="true"></i> Contribute
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li class="" role=""> 
                  <a class="padding" href="https://github.com/TIBCOSoftware/tci-flogo"><i class='fa fa-github'></i> Github repo</a>
              </li>
          
              <li class="" role=""> 
                  <a class="padding" href="https://tibcosoftware.github.io/tci-awesome"><i class='fa fa-camera'></i> Showcases</a>
              </li>
          
              <li class="" role=""> 
                  <a class="padding" href="https://integration.cloud.tibco.com/docs/index.html"><i class='fa fa-book'></i> TCI docs</a>
              </li>
          
              <li class="" role=""> 
                  <a class="padding" href="https://tibcosoftware.github.io/tci-flogo/wi-studio/v1.3.0/"><i class='fa fa-book'></i> Designtime API docs v1.3.0</a>
              </li>
          
              <li class="" role=""> 
                  <a class="padding" href="https://tibcosoftware.github.io/tci-flogo/wi-runtime/v1.3.0/pkg/github.com/index.html"><i class='fa fa-book'></i> Runtime API docs v1.3.0</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <center>
    
    <a class="github-button" href="https://github.com/TIBCOSoftware/tci-webintegrator/archive/master.zip" data-icon="octicon-cloud-download" aria-label="Download TIBCOSoftware/tci-webintegrator on GitHub">Download</a>

    
    <a class="github-button" href="https://github.com/TIBCOSoftware/tci-webintegrator" data-icon="octicon-star" data-show-count="true" aria-label="Star TIBCOSoftware/tci-webintegrator on GitHub">Star</a>

    
    <a class="github-button" href="https://github.com/TIBCOSoftware/tci-webintegrator/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork TIBCOSoftware/tci-webintegrator on GitHub">Fork</a>

</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>
    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable sticky-parent">
              
              <div class="sticky-spacer">
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/tci-flogo/'></a> > <a href='/tci-flogo/samples/'>Samples</a> > <a href='/tci-flogo/samples/amazon-sqs/'>Amazon SQS</a> > Sending a message
          
         
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#activity-json">activity.json</a></li>
<li><a href="#activity-module-ts">activity.module.ts</a></li>
<li><a href="#activity-ts">activity.ts</a></li>
<li><a href="#activity-go">activity.go</a></li>
<li><a href="#activity-test-go">activity_test.go</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Sending a message</h1>
          

        




<p>To send a message to Amazon SQS we&rsquo;ll create a Send Message activity. The API that we follow is documented by <a href="http://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_SendMessage.html">Amazon</a>.</p>

<h2 id="activity-json">activity.json</h2>

<pre><code>{
    &quot;name&quot;: &quot;sqssendmessage&quot;,
    &quot;version&quot;: &quot;1.0.0&quot;,
    &quot;author&quot;: &quot;TIBCO Software Inc.&quot;,
    &quot;type&quot;: &quot;flogo:activity&quot;,
    &quot;title&quot;: &quot;Send SQS Message&quot;,
     
    &quot;display&quot;: {
       &quot;category&quot;: &quot;AWSSQS&quot;,
       &quot;visible&quot;: true,
       &quot;smallIcon&quot;: &quot;sqssendmessage.png&quot;,
       &quot;description&quot;: &quot;This activity sends a message to the standard queue&quot;
    },
 
    &quot;ref&quot;: &quot;github.com/TIBCOSoftware/tci-flogo/examples/AWSSQS/activity/sqssendmessage&quot;,
    &quot;inputs&quot;: [
           {
            &quot;name&quot;: &quot;sqsConnection&quot;,
            &quot;type&quot;: &quot;object&quot;,
            &quot;required&quot;: true,
            &quot;display&quot;:{
              &quot;name&quot;: &quot;SQS Connection&quot;,
              &quot;description&quot;: &quot;Select SQS Connection&quot;,
              &quot;type&quot;: &quot;connection&quot;
            },
            &quot;allowed&quot;:[]
           },
           {
            &quot;name&quot;: &quot;queueUrl&quot;,
            &quot;type&quot;: &quot;string&quot;,
            &quot;required&quot;: true,
            &quot;display&quot;:{
              &quot;name&quot;: &quot;Queue URL&quot;,
              &quot;description&quot;: &quot;Select Queue URL&quot;
            },
            &quot;allowed&quot;:[]
           },
           {
            &quot;name&quot;: &quot;MessageAttributeNames&quot;,
            &quot;type&quot;: &quot;array&quot;,
            &quot;required&quot;: false,
            &quot;display&quot;: {
               &quot;name&quot;: &quot;Message Attributes&quot;,
               &quot;description&quot;: &quot;Set message attributes&quot;,
               &quot;type&quot;: &quot;table&quot;,
               &quot;schema&quot;: &quot;{\r\n    \&quot;$schema\&quot;: \&quot;http:\/\/json-schema.org\/draft-04\/schema#\&quot;,\r\n    \&quot;definitions\&quot;: {},\r\n    \&quot;id\&quot;: \&quot;http:\/\/example.com\/example.json\&quot;,\r\n    \&quot;items\&quot;: {\r\n        \&quot;id\&quot;: \&quot;\/items\&quot;,\r\n        \&quot;properties\&quot;: {\r\n            \&quot;Name\&quot;: {\r\n                \&quot;id\&quot;: \&quot;\/items\/properties\/Name\&quot;,\r\n                \&quot;type\&quot;: \&quot;string\&quot;\r\n            },\r\n            \&quot;Type\&quot;: {\r\n                \&quot;id\&quot;: \&quot;\/items\/properties\/Type\&quot;,\r\n                \&quot;type\&quot;: {\&quot;enum\&quot;:[\&quot;String\&quot;, \&quot;Number\&quot;]}\r\n            }\r\n        },\r\n        \&quot;type\&quot;: \&quot;object\&quot;\r\n    },\r\n    \&quot;type\&quot;: \&quot;array\&quot;\r\n}&quot;
            }
           },
           {
            &quot;name&quot;: &quot;MessageAttributes&quot;,
            &quot;type&quot;: &quot;complex_object&quot;,
            &quot;required&quot;: false
           }, 
           {
            &quot;name&quot;: &quot;DelaySeconds&quot;,
            &quot;type&quot;: &quot;integer&quot;,
            &quot;required&quot;: false
           },
           {
            &quot;name&quot;: &quot;MessageBody&quot;,
            &quot;type&quot;: &quot;string&quot;,
            &quot;required&quot;: true
           }
    ],
  
    &quot;outputs&quot;: [
           {
            &quot;name&quot;: &quot;MessageId&quot;,
            &quot;type&quot;: &quot;string&quot;
          }
    ]
}
</code></pre>

<h2 id="activity-module-ts">activity.module.ts</h2>

<pre><code class="language-typescript">import { HttpModule } from &quot;@angular/http&quot;;
import { NgModule } from &quot;@angular/core&quot;;
import { CommonModule } from &quot;@angular/common&quot;;
import { SQSSendMessageActivityContributionHandler} from &quot;./activity&quot;;
import { WiServiceContribution} from &quot;wi-studio/app/contrib/wi-contrib&quot;;


@NgModule({
  imports: [
  	CommonModule,
  	HttpModule,
  ],
  providers: [
    {
       provide: WiServiceContribution,
       useClass: SQSSendMessageActivityContributionHandler
     }
  ]
})

export default class ConcatActivityModule {

}
</code></pre>

<h2 id="activity-ts">activity.ts</h2>

<p>The TypeScript code to fetch the SQS connection and Queue URLs.</p>

<pre><code class="language-typescript">import { Observable } from &quot;rxjs/Observable&quot;;
import { Injectable, Injector, Inject } from &quot;@angular/core&quot;;
import { Http } from &quot;@angular/http&quot;;
import {
    WiContrib,
    WiServiceHandlerContribution,
    IValidationResult,
    ValidationResult,
    IFieldDefinition,
    IActivityContribution,
    IConnectorContribution,
    WiContributionUtils
} from &quot;wi-studio/app/contrib/wi-contrib&quot;;
import * as AWS from &quot;aws-sdk&quot;;

@WiContrib({})
@Injectable()
export class SendMsgActivityContribution extends WiServiceHandlerContribution {
    constructor( @Inject(Injector) injector, private http: Http) {
        super(injector, http);
    }

    value = (fieldName: string, context: IActivityContribution): Observable&lt;any&gt; | any =&gt; {
        if (fieldName === &quot;sqsConnection&quot;) {
            //Connector Type must match with the category defined in connector.json
            return Observable.create(observer =&gt; {
                let connectionRefs = [];
                WiContributionUtils.getConnections(this.http, &quot;AWSSQS&quot;).subscribe((data: IConnectorContribution[]) =&gt; {
                    data.forEach(connection =&gt; {
                        for (let i = 0; i &lt; connection.settings.length; i++) {
                            if (connection.settings[i].name === &quot;name&quot;) {
                                connectionRefs.push({
                                    &quot;unique_id&quot;: WiContributionUtils.getUniqueId(connection),
                                    &quot;name&quot;: connection.settings[i].value
                                });
                                break;
                            }
                        }
                    });
                    observer.next(connectionRefs);
                });
            });
        } else if (fieldName === &quot;MessageAttributes&quot;) {
            let msgAttrNames: IFieldDefinition = context.getField(&quot;MessageAttributeNames&quot;);
            if (msgAttrNames.value) {
                // Read message attrbutes and construct JSON schema on the fly for the activity input
                var jsonSchema = {};
                // Convert string value into JSON object
                let data = JSON.parse(msgAttrNames.value);
                for (var i = 0; i &lt; data.length; i++) {
                    if (data[i].Type === &quot;String&quot;) {
                        jsonSchema[data[i].Name] = &quot;abc&quot;;
                    } else if (data[i].Type === &quot;Number&quot;) {
                        jsonSchema[data[i].Name] = 0;
                    }
                }
                return JSON.stringify(jsonSchema);
            }
            return &quot;{}&quot;;
        } else if (fieldName === &quot;queueUrl&quot;) {
            let connectionField: IFieldDefinition = context.getField(&quot;sqsConnection&quot;);
            if (connectionField.value) {
                return Observable.create(observer =&gt; {
                    //Read connection configuration
                    let queueUrls = [];
                    WiContributionUtils.getConnection(this.http, connectionField.value)
                        .map(data =&gt; data)
                        .subscribe(data =&gt; {
                            let accessKeyId: IFieldDefinition;
                            let secreteKey: IFieldDefinition;
                            let region: IFieldDefinition;

                            for (let configuration of data.settings) {
                                if (configuration.name === &quot;accessKeyId&quot;) {
                                    accessKeyId = configuration
                                } else if (configuration.name === &quot;secreteAccessKey&quot;) {
                                    secreteKey = configuration
                                } else if (configuration.name === &quot;region&quot;) {
                                    region = configuration
                                }
                            }

                            var sqs = new AWS.SQS({
                                credentials: new AWS.Credentials(accessKeyId.value, secreteKey.value), region: region.value
                            });
                            var params = {};
                            sqs.listQueues(params, function (err, data) {
                                if (err) {
                                    observer.next(queueUrls);
                                } else {
                                    observer.next(data.QueueUrls);
                                }
                            });

                        });
                }
                );
            }
        }
        return null;
    }

    validate = (fieldName: string, context: IActivityContribution): Observable&lt;IValidationResult&gt; | IValidationResult =&gt; {
        if (fieldName === &quot;sqsConnection&quot;) {
            let connection: IFieldDefinition = context.getField(&quot;sqsConnection&quot;)
            if (connection.value === null) {
                return ValidationResult.newValidationResult().setError(&quot;AWS-SEND-MSG-1000&quot;, &quot;SQS Connection must be configured&quot;);
            }
        } else if (fieldName === &quot;queueUrl&quot;) {
            let queueUrl: IFieldDefinition = context.getField(&quot;queueUrl&quot;)
            if (queueUrl.value === null) {
                return ValidationResult.newValidationResult().setError(&quot;AWS-SEND-MSG-1001&quot;, &quot;Queue URL must be configured&quot;);
            }
        }
        return null;
    }
}
</code></pre>

<h2 id="activity-go">activity.go</h2>

<p>The runtime code</p>

<pre><code class="language-go">package sqssendmessage

import (
	&quot;fmt&quot;
	&quot;github.com/TIBCOSoftware/flogo-lib/core/activity&quot;
	&quot;github.com/TIBCOSoftware/flogo-lib/core/data&quot;
	&quot;github.com/TIBCOSoftware/flogo-lib/logger&quot;
	&quot;github.com/aws/aws-sdk-go/aws&quot;
	&quot;github.com/aws/aws-sdk-go/aws/credentials&quot;
	&quot;github.com/aws/aws-sdk-go/aws/session&quot;
	&quot;github.com/aws/aws-sdk-go/service/sqs&quot;
)

const (
	ivConnection            = &quot;sqsConnection&quot;
	ivQueueUrl              = &quot;queueUrl&quot;
	ivMessageAttributes     = &quot;MessageAttributes&quot;
	ivMessageAttributeNames = &quot;MessageAttributeNames&quot;
	ivDelaySeconds          = &quot;DelaySeconds&quot;
	ivMessageBody           = &quot;MessageBody&quot;
	ovMessageId             = &quot;MessageId&quot;
)

var activityLog = logger.GetLogger(&quot;aws-activity-sqssendmessage&quot;)

type SQSSendMessageActivity struct {
	metadata *activity.Metadata
}

func NewActivity(metadata *activity.Metadata) activity.Activity {
	return &amp;SQSSendMessageActivity{metadata: metadata}
}

func (a *SQSSendMessageActivity) Metadata() *activity.Metadata {
	return a.metadata
}
func (a *SQSSendMessageActivity) Eval(context activity.Context) (done bool, err error) {
	activityLog.Info(&quot;Executing SQS Send Message activity&quot;)
	//Read Inputs
	if context.GetInput(ivConnection) == nil {
		return false, activity.NewError(&quot;SQS connection is not configured&quot;, &quot;SQS-SENDMESSAGE-4001&quot;, nil)
	}

	if context.GetInput(ivQueueUrl) == nil {
		return false, activity.NewError(&quot;SQS Queue URL is not configured&quot;, &quot;SQS-SENDMESSAGE-4002&quot;, nil)
	}

	if context.GetInput(ivMessageBody) == nil {
		return false, activity.NewError(&quot;Message body is not configured&quot;, &quot;SQS-SENDMESSAGE-4003&quot;, nil)
	}

	//Read connection details
	connectionInfo := context.GetInput(ivConnection).(map[string]interface{})
	connectionSettings := connectionInfo[&quot;settings&quot;].([]interface{})
	var region string
	var accesskey string
	var secreteKey string
	for _, v := range connectionSettings {
		setting := v.(map[string]interface{})
		if setting[&quot;name&quot;] == &quot;accessKeyId&quot; {
			accesskey = setting[&quot;value&quot;].(string)
		} else if setting[&quot;name&quot;] == &quot;region&quot; {
			region = setting[&quot;value&quot;].(string)
		} else if setting[&quot;name&quot;] == &quot;secreteAccessKey&quot; {
			secreteKey = setting[&quot;value&quot;].(string)
		}
	}
	session, err := session.NewSession(aws.NewConfig().WithRegion(region).WithCredentials(credentials.NewStaticCredentials(accesskey, secreteKey, &quot;&quot;)))
	if err != nil {
		return false, activity.NewError(fmt.Sprintf(&quot;Failed to connect to AWS due to error:%s. Check credentials configured in the connection:%s.&quot;, err.Error(), connectionInfo[&quot;name&quot;].(string)), &quot;SQS-SENDMESSAGE-4004&quot;, nil)
	}
	//Create SQS service instance
	sqsSvc := sqs.New(session)
	sendMessageInput := &amp;sqs.SendMessageInput{}
	sendMessageInput.QueueUrl = aws.String(context.GetInput(ivQueueUrl).(string))
	sendMessageInput.MessageBody = aws.String(context.GetInput(ivMessageBody).(string))

	if context.GetInput(ivMessageAttributes) != nil &amp;&amp; context.GetInput(ivMessageAttributeNames) != nil {
		//Add message attributes

		//Read mapped values
		messageAttributes := context.GetInput(ivMessageAttributes).(*data.ComplexObject)
		if messageAttributes.Value != nil {
			switch messageAttributes.Value.(type) {
			case map[string]interface{}:
				msgAttrs := messageAttributes.Value.(map[string]interface{})

				//Read table values
				attrsName := context.GetInput(ivMessageAttributeNames).([]interface{})
				attrs := make(map[string]*sqs.MessageAttributeValue, len(msgAttrs))
				for _, v := range attrsName {
					attr := v.(map[string]interface{})
					// Has mapped value??
					if msgAttrs[attr[&quot;Name&quot;].(string)] != nil {
						attrVal, err := data.CoerceToString(msgAttrs[attr[&quot;Name&quot;].(string)])
						if err != nil &amp;&amp; attr[&quot;Type&quot;].(string) == &quot;Number&quot; {
							attrVal, err = data.CoerceToString(int(msgAttrs[attr[&quot;Name&quot;].(string)].(int64)))
						}
						attrs[attr[&quot;Name&quot;].(string)] = &amp;sqs.MessageAttributeValue{
							DataType:    aws.String(attr[&quot;Type&quot;].(string)),
							StringValue: aws.String(attrVal),
						}
					}
				}
				sendMessageInput.MessageAttributes = attrs
			}
		}
	}

	delaySeconds := context.GetInput(ivDelaySeconds)
	if delaySeconds != nil {
		sendMessageInput.DelaySeconds = aws.Int64(int64(delaySeconds.(int)))
	}

	//Send message to SQS
	response, err1 := sqsSvc.SendMessage(sendMessageInput)
	if err1 != nil {
		return false, activity.NewError(fmt.Sprintf(&quot;Failed to send message to SQS due to error:%s&quot;, err1.Error()), &quot;SQS-SENDMESSAGE-4005&quot;, nil)
	}

	//Set Message ID in the output
	context.SetOutput(ovMessageId, *response.MessageId)
	return true, nil
}
</code></pre>

<h2 id="activity-test-go">activity_test.go</h2>

<p>The unit tests</p>

<pre><code class="language-go">/*
 * Copyright © 2017. TIBCO Software Inc.
 * This file is subject to the license terms contained
 * in the license file that is distributed with this file.
 */
package sqssendmessage

import (
	&quot;io/ioutil&quot;
	&quot;testing&quot;

	&quot;github.com/TIBCOSoftware/flogo-contrib/action/flow/test&quot;
	&quot;github.com/TIBCOSoftware/flogo-lib/core/activity&quot;
	&quot;github.com/stretchr/testify/assert&quot;
)

var activityMetadata *activity.Metadata
var connectionData = ``

func getActivityMetadata() *activity.Metadata {
	if activityMetadata == nil {
		jsonMetadataBytes, err := ioutil.ReadFile(&quot;activity.json&quot;)
		if err != nil {
			panic(&quot;No Json Metadata found for activity.json path&quot;)
		}
		activityMetadata = activity.NewMetadata(string(jsonMetadataBytes))
	}
	return activityMetadata
}

func TestActivityRegistration(t *testing.T) {
	act := NewActivity(getActivityMetadata())
	if act == nil {
		t.Error(&quot;Activity Not Registered&quot;)
		t.Fail()
		return
	}
}

func TestEval(t *testing.T) {
	act := NewActivity(getActivityMetadata())
	tc := test.NewTestActivityContext(act.Metadata())

	dummyConnectionData := make(map[string]interface{})
	dummyConnectionSettings := make(map[string]interface{}, 4)
	//Use your AWS information
	dummyConnectionSettings[&quot;accessKeyId&quot;] = &quot;&lt;YOUR ACCESS KEY ID&gt;&quot;
	dummyConnectionSettings[&quot;secreteAccessKey&quot;] = &quot;&lt;YOUR SECRETE ACCESS KEY&gt;&quot;
	dummyConnectionSettings[&quot;region&quot;] = &quot;&lt;REGION NAME WHERE SQS IS RUNNING&gt;&quot;
	dummyConnectionSettings[&quot;name&quot;] = &quot;My SQS Connection&quot;

	dummyConnectionData[&quot;settings&quot;] = dummyConnectionSettings

	tc.SetInput(ivConnection, dummyConnectionData)
	tc.SetInput(ivQueueUrl, &quot;&lt;YOUR SQS QUEUE URL&gt;&quot;)
	tc.SetInput(ivMessageBody, &quot;Message from TIBCO&quot;)

	_, err := act.Eval(tc)
	assert.Nil(t, err)
}
</code></pre>


<footer class=" footline" >
	
</footer>


        
        </div> 
      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/tci-flogo/samples/amazon-sqs/sqs-connector/" title="Connector"> <i class="fa fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/tci-flogo/samples/amazon-sqs/sqs-receive-message/" title="Receiving a message" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/tci-flogo/js/clipboard.min.js?1523556550"></script>
    <script src="/tci-flogo/js/perfect-scrollbar.min.js?1523556550"></script>
    <script src="/tci-flogo/js/perfect-scrollbar.jquery.min.js?1523556550"></script>
    <script src="/tci-flogo/js/jquery.sticky-kit.min.js?1523556550"></script>
    <script src="/tci-flogo/js/featherlight.min.js?1523556550"></script>
    <script src="/tci-flogo/js/html5shiv-printshiv.min.js?1523556550"></script>
    <script src="/tci-flogo/js/highlight.pack.js?1523556550"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/tci-flogo/js/modernizr.custom.71422.js?1523556550"></script>
    <script src="/tci-flogo/js/learn.js?1523556550"></script>
    <script src="/tci-flogo/js/hugo-learn.js?1523556550"></script>

    <link href="/tci-flogo/mermaid/mermaid.css?1523556550" type="text/css" rel="stylesheet" />
    <script src="/tci-flogo/mermaid/mermaid.js?1523556550"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

